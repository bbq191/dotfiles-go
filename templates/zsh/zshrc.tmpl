#!/usr/bin/env zsh
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                    ğŸš€ dotfiles-go ZSH é…ç½®æ–‡ä»¶ ğŸš€                            â•‘
# â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
# â•‘ å¹³å°: {{.Platform.OS}}/{{.Platform.Architecture}}{{if .Platform.WSL}} (WSL2: {{.Platform.WSL.Distribution}}){{end}}                                    â•‘
# â•‘ ç”Ÿæˆæ—¶é—´: {{now | date "2006-01-02 15:04:05"}}                                                   â•‘
# â•‘ ç”Ÿæˆå·¥å…·: dotfiles-go                                                        â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{{if .ZshConfig.XDGDirectories.Enabled}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                       ğŸ“ XDG åŸºç¡€ç›®å½•è§„èŒƒé…ç½®                                  â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ—‚ï¸ XDG æ ‡å‡†ç›®å½•ç»“æ„
export XDG_CONFIG_HOME={{xdgPath "config" .}}  # ğŸ”§ é…ç½®æ–‡ä»¶ç›®å½•
export XDG_DATA_HOME={{xdgPath "data" .}}      # ğŸ“Š æ•°æ®æ–‡ä»¶ç›®å½•
export XDG_CACHE_HOME={{xdgPath "cache" .}}    # ğŸ’¾ ç¼“å­˜æ–‡ä»¶ç›®å½•
export XDG_STATE_HOME={{xdgPath "state" .}}    # ğŸ“ çŠ¶æ€æ–‡ä»¶ç›®å½•

# ğŸ  ZSH ä¸“ç”¨ç›®å½•
export ZDOTDIR="$XDG_CONFIG_HOME/zsh"          # ğŸš Zsh é…ç½®ç›®å½•
export HISTFILE="$XDG_STATE_HOME/zsh/history"  # ğŸ“š Zsh å†å²æ–‡ä»¶

# ğŸ“ ç¡®ä¿ç›®å½•å­˜åœ¨
mkdir -p "$XDG_CONFIG_HOME" "$XDG_DATA_HOME" "$XDG_CACHE_HOME" "$XDG_STATE_HOME"
mkdir -p "$ZDOTDIR" "$XDG_STATE_HOME/zsh"

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                       ğŸ› ï¸ åº”ç”¨ç¨‹åº XDG é€‚é…é…ç½®                                  â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ”— Git é…ç½®
export GIT_CONFIG_GLOBAL="$XDG_CONFIG_HOME/git/config"  # Git å…¨å±€é…ç½®
mkdir -p "$XDG_CONFIG_HOME/git"

# ğŸŸ¢ Node.js & NPM é…ç½®
if [[ -z "$NVM_DIR" && ! -d "$HOME/.nvm" && ! $(command -v fnm) && ! $(command -v volta) ]]; then
    export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
    export NODE_REPL_HISTORY="$XDG_DATA_HOME/node_repl_history"
    mkdir -p "$XDG_CONFIG_HOME/npm" "$XDG_DATA_HOME"
else
    export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
    mkdir -p "$XDG_CONFIG_HOME/npm"
fi

# ğŸ Python é…ç½®
if [[ -z "$CONDA_DEFAULT_ENV" && -z "$VIRTUAL_ENV" && -z "$PYENV_ROOT" && ! $(command -v poetry) ]]; then
    export PYTHONSTARTUP="$XDG_CONFIG_HOME/python/pythonrc"
    mkdir -p "$XDG_CONFIG_HOME/python"
fi

export PYLINTHOME="$XDG_CACHE_HOME/pylint"       # ğŸ” Pylint ç¼“å­˜
export JUPYTER_CONFIG_DIR="$XDG_CONFIG_HOME/jupyter"  # ğŸ““ Jupyter é…ç½®
mkdir -p "$XDG_CACHE_HOME/pylint" "$XDG_CONFIG_HOME/jupyter"

# ğŸ¹ Go é…ç½®
if [[ ! $(command -v g) && -z "$GVM_ROOT" && -z "$GOPATH" ]]; then
    export GOPATH="$XDG_DATA_HOME/go"  # Go å·¥ä½œç©ºé—´
    mkdir -p "$GOPATH"
fi

export GOCACHE="$XDG_CACHE_HOME/go-build"  # ğŸ—ï¸ Go ç¼–è¯‘ç¼“å­˜
mkdir -p "$GOCACHE"

# ğŸ³ Docker é…ç½®
export DOCKER_CONFIG="$XDG_CONFIG_HOME/docker"        # Docker é…ç½®
mkdir -p "$DOCKER_CONFIG"

# âœï¸ Vim/Neovim é…ç½®
export VIMINIT='let $MYVIMRC = !has("nvim") ? "$XDG_CONFIG_HOME/vim/vimrc" : "$XDG_CONFIG_HOME/nvim/init.lua" | so $MYVIMRC'
mkdir -p "$XDG_CONFIG_HOME/vim" "$XDG_CONFIG_HOME/nvim"
mkdir -p "$XDG_DATA_HOME/vim" "$XDG_DATA_HOME/nvim"
mkdir -p "$XDG_CACHE_HOME/vim" "$XDG_CACHE_HOME/nvim"
mkdir -p "$XDG_STATE_HOME/vim" "$XDG_STATE_HOME/nvim"

# ğŸ“– å…¶ä»–å·¥å…·é…ç½®
export LESSHISTFILE="$XDG_STATE_HOME/less/history"     # Less å†å²
export WGETRC="$XDG_CONFIG_HOME/wget/wgetrc"           # Wget é…ç½®
export GNUPGHOME="$XDG_DATA_HOME/gnupg"               # ğŸ” GnuPG ç›®å½•

# ğŸ“ åˆ›å»ºé…ç½®ç›®å½•
mkdir -p "$XDG_STATE_HOME/less" "$XDG_CONFIG_HOME/wget"
mkdir -p "$GNUPGHOME" && chmod 700 "$GNUPGHOME"

{{end}}

{{if .ZshConfig.Proxy.Enabled}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                           ğŸŒ ç½‘ç»œä»£ç†é…ç½®                                      â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{$activeProxy := getActiveProxy}}
{{if $activeProxy}}
{{if index $activeProxy "https_proxy"}}{{$httpsProxy := expandEnv (index $activeProxy "https_proxy")}}{{if $httpsProxy}}
export HTTPS_PROXY="{{$httpsProxy}}"  # ğŸ”’ HTTPS ä»£ç†
{{end}}{{end}}{{if index $activeProxy "http_proxy"}}{{$httpProxy := expandEnv (index $activeProxy "http_proxy")}}{{if $httpProxy}}
export HTTP_PROXY="{{$httpProxy}}"    # ğŸŒ HTTP ä»£ç†
{{end}}{{end}}{{if index $activeProxy "all_proxy"}}{{$allProxy := expandEnv (index $activeProxy "all_proxy")}}{{if $allProxy}}
export ALL_PROXY="{{$allProxy}}"      # ğŸ§¦ SOCKS ä»£ç†
{{end}}{{end}}{{if index $activeProxy "no_proxy"}}{{$noProxy := expandEnv (index $activeProxy "no_proxy")}}{{if $noProxy}}
export NO_PROXY="{{$noProxy}}"        # âŒ ä»£ç†ä¾‹å¤–åˆ—è¡¨
{{end}}{{end}}
{{end}}

# ğŸ”§ ä»£ç†ç®¡ç†å‡½æ•°
proxy_on() {  # å¯ç”¨ä»£ç†: proxy_on [profile]
    local profile=${1:-"default"}
    echo "ğŸ“‹ å¯ç”¨çš„ä»£ç†é…ç½®:"
    {{range $name, $profile := .ZshConfig.Proxy.Profiles}}
    {{if ne $name "none"}}
    echo "  ğŸ“¡ {{$name}}"
    {{end}}
    {{end}}

    if [[ -n "$1" ]]; then
        export PROXY_PROFILE="$1"
        echo "âœ… å·²åˆ‡æ¢åˆ°ä»£ç†é…ç½®: $1"
        echo "ğŸ”„ è¯·é‡æ–°åŠ è½½ shell æˆ–æ‰§è¡Œ 'source ~/.zshrc' ä½¿é…ç½®ç”Ÿæ•ˆ"
    fi
}

proxy_off() {  # ç¦ç”¨ä»£ç†
    unset https_proxy HTTPS_PROXY http_proxy HTTP_PROXY all_proxy ALL_PROXY no_proxy NO_PROXY
    echo "ğŸš« ä»£ç†å·²ç¦ç”¨"
}
{{end}}

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         âš™ï¸ æ ¸å¿ƒç¯å¢ƒå˜é‡é…ç½®                                    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ› ï¸ é»˜è®¤å·¥å…·é…ç½®
{{if .User.Editor}}
export EDITOR="{{.User.Editor}}"     # âœï¸ é»˜è®¤ç¼–è¾‘å™¨
{{else}}
export EDITOR="nvim"                  # âœï¸ é»˜è®¤ç¼–è¾‘å™¨
{{end}}

{{if .User.Browser}}
export BROWSER="{{.User.Browser}}"   # ğŸŒ é»˜è®¤æµè§ˆå™¨
{{else}}
export BROWSER="firefox"              # ğŸŒ é»˜è®¤æµè§ˆå™¨
{{end}}

export PAGER="less -R"               # ğŸ“„ åˆ†é¡µå™¨
export MANPAGER="less -R"            # ğŸ“š æ‰‹å†Œåˆ†é¡µå™¨

# ğŸ¨ ç»ˆç«¯ç¯å¢ƒé…ç½®
export TERM="xterm-256color"     # ğŸ–¥ï¸ ç»ˆç«¯ç±»å‹
export COLORTERM="truecolor"     # ğŸŒˆ çœŸå½©è‰²æ”¯æŒ
export LESS="-R"                 # ğŸ¨ Less é¢œè‰²æ”¯æŒ

{{if .Environment}}
# ğŸ”§ ç”¨æˆ·è‡ªå®šä¹‰ç¯å¢ƒå˜é‡
{{range $key, $value := .Environment}}
{{if and (ne $key "EDITOR") (ne $key "BROWSER")}}
{{$envValue := expandEnv $value}}
{{if $envValue}}
export {{$key}}="{{$envValue}}"  # ğŸ›ï¸ {{$key}} é…ç½®
{{end}}
{{end}}
{{end}}
{{end}}

{{if .Platform.WSL}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                          ğŸªŸ WSL ç‰¹å®šé…ç½®                                       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ–¥ï¸ X11 æ˜¾ç¤ºé…ç½®
export DISPLAY="$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0"
export LIBGL_ALWAYS_INDIRECT=1  # ğŸ® OpenGL é—´æ¥æ¸²æŸ“

{{if .Platform.WSL.WindowsHome}}
# ğŸ  Windows ç›®å½•å¿«æ·æ–¹å¼
export WINDOWS_HOME="{{.Platform.WSL.WindowsHome}}"  # Windows ç”¨æˆ·ç›®å½•
export WINHOME="{{.Platform.WSL.WindowsHome}}"       # Windows ç”¨æˆ·ç›®å½•ç¼©å†™
export DESKTOP="{{.Platform.WSL.WindowsHome}}/Desktop"    # ğŸ–¥ï¸ Windows æ¡Œé¢
export DOWNLOADS="{{.Platform.WSL.WindowsHome}}/Downloads"  # ğŸ“¥ Windows ä¸‹è½½
export DOCUMENTS="{{.Platform.WSL.WindowsHome}}/Documents"  # ğŸ“„ Windows æ–‡æ¡£
{{end}}
{{end}}

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                          ğŸ“‚ ç³»ç»Ÿè·¯å¾„é…ç½®                                       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ›£ï¸ ç”¨æˆ·è·¯å¾„é…ç½®
{{if .ZshConfig.XDGDirectories.Enabled}}
export PATH="$XDG_DATA_HOME/bin:$HOME/.local/bin:$PATH"  # ğŸ”§ ç”¨æˆ·æœ¬åœ°äºŒè¿›åˆ¶ç›®å½•
{{else}}
export PATH="$HOME/.local/bin:$PATH"  # ğŸ”§ ç”¨æˆ·æœ¬åœ°äºŒè¿›åˆ¶ç›®å½•
{{end}}

# ğŸ“ é¡¹ç›®ç›®å½•é…ç½®
{{if .Paths.Projects}}
{{$projectsPath := getPlatformValue .Paths.Projects}}
{{if $projectsPath}}
export PROJECTS_DIR="{{expandEnv $projectsPath}}"  # ğŸš€ é¡¹ç›®ç›®å½•
{{end}}
{{else if .Platform.WSL}}
{{if .Platform.WSL.WindowsHome}}
export PROJECTS_DIR="{{.Platform.WSL.WindowsHome}}/Projects"  # ğŸš€ WSL é¡¹ç›®ç›®å½•
{{end}}
{{else}}
export PROJECTS_DIR="$HOME/Projects"  # ğŸš€ é»˜è®¤é¡¹ç›®ç›®å½•
{{end}}

{{if .ZshConfig.Performance}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                       âš¡ é«˜æ€§èƒ½å¼€å‘ç¯å¢ƒé…ç½®                                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ¹ Go å¼€å‘ç¯å¢ƒä¼˜åŒ–
export GOMAXPROCS=20                            # ğŸš€ å¤šæ ¸CPUåˆ©ç”¨
export GOCACHE="$XDG_CACHE_HOME/go-build"       # ğŸ’¾ ç¼–è¯‘ç¼“å­˜
export GOMODCACHE="$XDG_CACHE_HOME/go/mod"      # ğŸ“¦ æ¨¡å—ç¼“å­˜
{{if not .ZshConfig.VersionManagers.g.Enabled}}
export GOPATH="${GOPATH:-$XDG_DATA_HOME/go}"    # ğŸ  Goå·¥ä½œç©ºé—´
{{end}}
export GOPROXY="https://goproxy.cn,direct"     # ğŸš€ Goä»£ç†åŠ é€Ÿ
export CGO_ENABLED=1                            # ğŸ”§ å¯ç”¨CGO

# â˜• Java å¼€å‘ç¯å¢ƒä¼˜åŒ–
export _JAVA_OPTIONS="-XX:+UseG1GC -XX:MaxGCPauseMillis=200 -Xms8g -Xmx32g -XX:+UseStringDeduplication"  # ğŸš€ Java JVMä¼˜åŒ–
export MAVEN_OPTS="-Xms4g -Xmx16g -XX:+TieredCompilation -XX:TieredStopAtLevel=1"  # âš¡ Mavenä¼˜åŒ–
export GRADLE_OPTS="-Xms4g -Xmx16g -Dorg.gradle.daemon=true -Dorg.gradle.parallel=true -Dorg.gradle.workers.max=20"  # ğŸ˜ Gradleä¼˜åŒ–

# ğŸŸ¢ Node.js ç¯å¢ƒä¼˜åŒ–
export NODE_OPTIONS="--max-old-space-size=8192 --max-semi-space-size=256"  # ğŸ§  Node.jså†…å­˜ä¼˜åŒ–
export UV_THREADPOOL_SIZE=20  # ğŸ§µ Node.jsçº¿ç¨‹æ± 
export NPM_CONFIG_CACHE="$XDG_CACHE_HOME/npm"
export NPM_CONFIG_PREFIX="$XDG_DATA_HOME/npm"
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"

# .NET XDG é…ç½®
export DOTNET_CLI_HOME="$XDG_DATA_HOME/dotnet"
export NUGET_PACKAGES="$XDG_CACHE_HOME/NuGet/packages"
export NUGET_HTTP_CACHE_PATH="$XDG_CACHE_HOME/NuGet/http-cache"
export NUGET_PLUGINS_CACHE_PATH="$XDG_CACHE_HOME/NuGet/plugins-cache"

# ğŸ Python AI å¼€å‘ç¯å¢ƒä¼˜åŒ–
{{if not .ZshConfig.VersionManagers.pyenv.Enabled}}
export PYTHONPATH="$XDG_DATA_HOME/python"        # ğŸ“š Pythonè·¯å¾„
export PYTHON_HISTORY="$XDG_STATE_HOME/python/history"  # ğŸ“œ Pythonå†å²
{{end}}
export PIPENV_VENV_IN_PROJECT=1  # ğŸ“ Pipenvè™šæ‹Ÿç¯å¢ƒ
export PIPX_HOME="$XDG_DATA_HOME/pipx"           # ğŸ“¦ Pipxç›®å½•
export PIPX_BIN_DIR="$XDG_DATA_HOME/pipx/bin"    # ğŸ”§ PipxäºŒè¿›åˆ¶

# ğŸ¦€ Rust ç¯å¢ƒä¼˜åŒ–
export CARGO_HOME="$XDG_DATA_HOME/cargo"         # ğŸ“¦ Cargoç›®å½•
export RUSTUP_HOME="$XDG_DATA_HOME/rustup"       # ğŸ¦€ Rustupç›®å½•
export CARGO_BUILD_JOBS=20                       # ğŸš€ å¹¶è¡Œç¼–è¯‘
export CARGO_TARGET_DIR="$XDG_CACHE_HOME/cargo-target"  # ğŸ’¾ Cargoç¼“å­˜

# ğŸ¤– AI å¼€å‘é…ç½® (Ollama)
export OLLAMA_HOST="127.0.0.1:11434"             # ğŸ  OllamaæœåŠ¡å™¨
export OLLAMA_MODELS="$XDG_DATA_HOME/ollama/models"  # ğŸ§  Ollamaæ¨¡å‹ç›®å½•
export OLLAMA_NUM_PARALLEL=4                     # ğŸ”„ å¹¶è¡Œè¯·æ±‚æ•°
export OLLAMA_MAX_LOADED_MODELS=3                # ğŸ“Š æœ€å¤§åŠ è½½æ¨¡å‹
export OLLAMA_GPU_MEMORY_FRACTION=0.9            # ğŸ® GPUå†…å­˜åˆ†é…
export CUDA_VISIBLE_DEVICES=0                    # ğŸ® CUDAè®¾å¤‡

# ğŸ—„ï¸ æ•°æ®åº“æ€§èƒ½é…ç½®
export MARIADB_HISTFILE="$XDG_STATE_HOME/mariadb/history"  # ğŸ“Š MariaDBå†å²
export MYSQL_HISTFILE="$XDG_STATE_HOME/mariadb/history"    # ğŸ“Š MySQLå†å²å…¼å®¹
export MYSQL_HOST="127.0.0.1"                             # ğŸ  MariaDBé»˜è®¤ä¸»æœº
export MYSQL_TCP_PORT="3306"                              # ğŸ”Œ MariaDBé»˜è®¤ç«¯å£
export MYSQL_CONFIG="$XDG_CONFIG_HOME/mariadb/my.cnf"      # ğŸ“ MariaDBé…ç½®æ–‡ä»¶
export MARIADB_CONFIG="$XDG_CONFIG_HOME/mariadb/my.cnf"    # ğŸ“ MariaDBé…ç½®æ–‡ä»¶
export MARIADB_OPTS="--innodb-buffer-pool-size=30G --max-connections=800 --innodb-thread-concurrency=40 --query-cache-size=512M --innodb-log-file-size=2G --innodb-flush-log-at-trx-commit=2 --thread-pool-size=20 --innodb-read-io-threads=8 --innodb-write-io-threads=8 --innodb-io-capacity=2000"  # ğŸš€ MariaDBæ€§èƒ½ä¼˜åŒ–

export VALKEY_CONF="$XDG_CONFIG_HOME/valkey/valkey.conf"   # âš¡ Valkeyé…ç½®
export REDIS_CONF="$XDG_CONFIG_HOME/valkey/valkey.conf"    # âš¡ Rediså…¼å®¹è·¯å¾„
export VALKEY_HOST="127.0.0.1"                            # ğŸ  Valkeyé»˜è®¤ä¸»æœº
export VALKEY_PORT="6379"                                 # ğŸ”Œ Valkeyé»˜è®¤ç«¯å£
export VALKEY_OPTS="--maxmemory 8gb --maxmemory-policy allkeys-lru --save '900 1' --save '300 10' --save '60 10000' --tcp-backlog 511 --timeout 300 --io-threads 8 --io-threads-do-reads yes"  # ğŸš€ Valkeyæ€§èƒ½ä¼˜åŒ–

export PSQLRC="$XDG_CONFIG_HOME/postgresql/psqlrc"         # ğŸ˜ PostgreSQLé…ç½®æ–‡ä»¶
export PSQL_HISTORY="$XDG_STATE_HOME/postgresql/history"   # ğŸ“œ PostgreSQLå†å²
export PGHOST="127.0.0.1"                                 # ğŸ  PostgreSQLé»˜è®¤ä¸»æœº
export PGPORT="5432"                                       # ğŸ”Œ PostgreSQLé»˜è®¤ç«¯å£
export PGOPTIONS="-c shared_preload_libraries=pg_stat_statements -c max_connections=200 -c shared_buffers=12GB -c effective_cache_size=36GB -c work_mem=128MB -c maintenance_work_mem=2GB -c max_worker_processes=20 -c max_parallel_workers=20 -c max_parallel_workers_per_gather=10"  # ğŸš€ PostgreSQLæ€§èƒ½ä¼˜åŒ–

# âš¡ ç¼–è¯‘å™¨æ€§èƒ½ä¼˜åŒ–
export MAKEFLAGS="-j20"      # ğŸ”¨ Makeå¹¶è¡Œç¼–è¯‘
export CC="gcc"              # ğŸ”§ Cç¼–è¯‘å™¨
export CXX="g++"             # ğŸ”§ C++ç¼–è¯‘å™¨
export CFLAGS="-march=native -mtune=native -O3 -pipe"  # ğŸš€ Cç¼–è¯‘é€‰é¡¹
export CXXFLAGS="$CFLAGS"    # ğŸš€ C++ç¼–è¯‘é€‰é¡¹
{{end}}

{{if .ZshConfig.VersionManagers}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ”„ ç‰ˆæœ¬ç®¡ç†å™¨é…ç½®                                        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ› ï¸ ç‰ˆæœ¬ç®¡ç†å™¨ç¯å¢ƒå˜é‡
{{range $name, $vm := .ZshConfig.VersionManagers}}
{{if $vm.Enabled}}
# {{$name | title}} ç¯å¢ƒå˜é‡
{{if $vm.EnvVars}}{{range $key, $value := $vm.EnvVars}}
export {{$key}}="{{getPlatformValue $value}}"  # ğŸ”§ {{$name}} {{$key}}
{{end}}{{end}}
{{end}}
{{end}}

# ğŸ›£ï¸ ç‰ˆæœ¬ç®¡ç†å™¨ PATH é…ç½®
{{$pathAdditions := list}}{{range $name, $vm := .ZshConfig.VersionManagers}}{{if $vm.Enabled}}{{if $vm.PathAdditions}}{{range $path := $vm.PathAdditions}}{{$pathAdditions = append $pathAdditions $path}}{{end}}{{end}}{{end}}{{end}}{{if $pathAdditions}}
export PATH="{{join ":" $pathAdditions}}:$PATH"  # ğŸ”§ ç‰ˆæœ¬ç®¡ç†å™¨ PATH
{{end}}

# ğŸš€ ç‰ˆæœ¬ç®¡ç†å™¨åˆå§‹åŒ–
if [[ -f "$SDKMAN_DIR/bin/sdkman-init.sh" ]]; then  # â˜• Sdkman
    source "$SDKMAN_DIR/bin/sdkman-init.sh"
fi

{{range $name, $vm := .ZshConfig.VersionManagers}}
{{if $vm.Enabled}}
{{if $vm.InitCommand}}
if command -v {{$name}} >/dev/null 2>&1; then  # ğŸ”§ {{$name | title}}
    {{$vm.InitCommand | replace "{shell}" "zsh"}}
fi
{{else if eq $name "fnm"}}
if command -v fnm >/dev/null 2>&1; then  # ğŸŸ¢ FNM Node.js
    eval "$(fnm env --use-on-cd --shell zsh)"
fi
{{else if eq $name "pyenv"}}
if command -v pyenv >/dev/null 2>&1; then  # ğŸ Pyenv Python
    eval "$(pyenv init - zsh)"
fi
{{else if eq $name "g"}}
[ -s "${G_HOME}/env" ] && \. "${G_HOME}/env"  # ğŸ¹ G Goç‰ˆæœ¬ç®¡ç†
{{end}}
{{end}}
{{end}}

hash -r 2>/dev/null || true  # ğŸ”„ æ¸…é™¤å‘½ä»¤ç¼“å­˜
{{end}}

{{if .ZshConfig.HistoryAdvanced}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         ğŸ“š æ™ºèƒ½å†å²è®°å½•é…ç½®                                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ“Š å†å²è®°å½•åŸºæœ¬é…ç½®
HISTSIZE={{.ZshConfig.HistoryAdvanced.Size | default 50000}}    # ğŸ§  å†…å­˜ä¸­å†å²æ•°é‡
SAVEHIST={{.ZshConfig.HistoryAdvanced.SaveSize | default 50000}}  # ğŸ’¾ ä¿å­˜å†å²æ•°é‡
{{if .ZshConfig.XDGDirectories.Enabled}}
HISTFILE="$XDG_STATE_HOME/zsh/history"  # ğŸ“ å†å²æ–‡ä»¶è·¯å¾„
{{else}}
HISTFILE="$HOME/.zsh_history"           # ğŸ“ å†å²æ–‡ä»¶è·¯å¾„
{{end}}

# âš™ï¸ å†å²è®°å½•è¡Œä¸ºä¼˜åŒ–
setopt EXTENDED_HISTORY       # ğŸ•’ ä¿å­˜æ—¶é—´æˆ³
setopt HIST_EXPIRE_DUPS_FIRST # ğŸ”„ ä¼˜å…ˆæ¸…ç†é‡å¤
setopt HIST_IGNORE_DUPS       # âŒ å¿½ç•¥è¿ç»­é‡å¤
setopt HIST_IGNORE_ALL_DUPS   # âŒ ç§»é™¤æ‰€æœ‰é‡å¤
setopt HIST_FIND_NO_DUPS      # ğŸ” æœç´¢æ—¶ä¸æ˜¾ç¤ºé‡å¤
setopt HIST_IGNORE_SPACE      # âšª å¿½ç•¥ç©ºæ ¼å¼€å¤´å‘½ä»¤
setopt HIST_SAVE_NO_DUPS      # ğŸ’¾ ä¸ä¿å­˜é‡å¤
setopt HIST_VERIFY            # âœ… æ‰§è¡Œå‰æ˜¾ç¤ºå†å²å‘½ä»¤
setopt INC_APPEND_HISTORY     # âš¡ å®æ—¶æ·»åŠ å†å²
setopt SHARE_HISTORY          # ğŸ”„ ä¼šè¯é—´å…±äº«å†å²

{{if .ZshConfig.HistoryAdvanced.BackupDir}}
# ğŸ’¾ å†å²è®°å½•å¤‡ä»½åŠŸèƒ½
backup_history() {  # å¤‡ä»½å†å²è®°å½•
    local backup_dir="{{expandEnv .ZshConfig.HistoryAdvanced.BackupDir}}"
    mkdir -p "$backup_dir"
    cp "$HISTFILE" "$backup_dir/zsh_history_$(date +%Y%m%d_%H%M%S)"
    echo "âœ… å†å²è®°å½•å·²å¤‡ä»½åˆ° $backup_dir"
}
{{end}}
{{end}}

{{if .ZshConfig.ModernTools.Replacements}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ”§ ç°ä»£åŒ–å·¥å…·é›†æˆ                                        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{range $old, $replacement := .ZshConfig.ModernTools.Replacements}}
{{if $replacement.Tool}}

if command -v {{$replacement.Tool}} >/dev/null 2>&1; then  # ğŸ†• {{$old}} â†’ {{$replacement.Tool}}
    {{if $replacement.Aliases}}
    {{range $alias, $cmd := $replacement.Aliases}}
    alias {{$alias}}="{{$cmd}}"  # ğŸ”— {{$alias}} åˆ«å
    {{end}}
    {{end}}
    {{if $replacement.InitCommand}}
    {{$replacement.InitCommand | replace "{shell}" (shellName)}}  # ğŸš€ {{$replacement.Tool}} åˆå§‹åŒ–
    {{end}}
    {{if $replacement.EnvVars}}
    {{range $key, $value := $replacement.EnvVars}}
    export {{$key}}="{{$value}}"  # âš™ï¸ {{$replacement.Tool}} {{$key}}
    {{end}}
    {{end}}
{{if $replacement.Fallback}}
else
    alias {{$old}}="{{$replacement.Fallback}}"  # â¬‡ï¸ é™çº§æ–¹æ¡ˆ
{{end}}
fi
{{end}}
{{end}}
{{end}}

{{if .ZshConfig.FzfConfig.Enabled}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ” FZF æ¨¡ç³ŠæŸ¥æ‰¾å™¨é…ç½®                                    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{if .ZshConfig.FzfConfig.Commands}}
# ğŸ“Š FZF æ•°æ®æºå‘½ä»¤
{{range $key, $cmd := .ZshConfig.FzfConfig.Commands}}
export FZF_{{upper $key}}_COMMAND="{{$cmd}}"  # ğŸ”§ {{upper $key}} å‘½ä»¤
{{end}}
{{end}}

{{if .ZshConfig.FzfConfig.Theme}}
# ğŸ¨ FZF ä¸»é¢˜é…ç½®
{{if typeIs "string" .ZshConfig.FzfConfig.Theme}}
export FZF_DEFAULT_OPTS="{{.ZshConfig.FzfConfig.Theme}}"  # ğŸ¨ å­—ç¬¦ä¸²ä¸»é¢˜
{{else}}
export FZF_DEFAULT_OPTS="{{formatFzfTheme .ZshConfig.FzfConfig.Theme}}"  # ğŸ¨ ç»“æ„åŒ–ä¸»é¢˜
{{end}}
{{end}}

{{if .ZshConfig.FzfConfig.Preview}}
# ğŸ‘ï¸ FZF é¢„è§ˆåŠŸèƒ½
{{range $key, $cmd := .ZshConfig.FzfConfig.Preview}}
export FZF_{{upper $key}}_PREVIEW="{{$cmd}}"  # ğŸ‘ï¸ {{upper $key}} é¢„è§ˆ
{{end}}
{{end}}

# ğŸ¯ FZF Shell é›†æˆ
if command -v fzf >/dev/null 2>&1; then
    # âŒ¨ï¸ é”®ç»‘å®šæ¨¡å— (Ctrl+T, Ctrl+R, Alt+C)
    [[ -f /usr/share/fzf/key-bindings.zsh ]] && source /usr/share/fzf/key-bindings.zsh
    # ğŸ“ è¡¥å…¨å¢å¼ºæ¨¡å— (** è§¦å‘ã€è¿›ç¨‹IDè¡¥å…¨ç­‰)
    [[ -f /usr/share/fzf/completion.zsh ]] && source /usr/share/fzf/completion.zsh
fi
{{end}}

{{if .ZshConfig.CompletionAdvanced}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ§  ZSH æ™ºèƒ½è¡¥å…¨ç³»ç»Ÿ                                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

autoload -Uz compinit  # ğŸ”§ åŠ è½½è¡¥å…¨ç³»ç»Ÿ

# ğŸš€ è¡¥å…¨ç³»ç»Ÿåˆå§‹åŒ–
{{if .ZshConfig.XDGDirectories.Enabled}}
if [[ $ZSH_DISABLE_COMPFIX != true ]]; then
    compinit -d "$XDG_CACHE_HOME/zsh/zcompdump-$ZSH_VERSION"  # ğŸ”’ å®‰å…¨æ¨¡å¼
else
    compinit -u -d "$XDG_CACHE_HOME/zsh/zcompdump-$ZSH_VERSION"  # âš¡ å¿«é€Ÿæ¨¡å¼
fi
{{else}}
compinit  # ğŸ”§ ä¼ ç»Ÿæ¨¡å¼
{{end}}

# âš™ï¸ è¡¥å…¨è¡Œä¸ºé…ç½®
zstyle ':completion:*' menu select            # ğŸ“‹ å¯ç”¨èœå•é€‰æ‹©
zstyle ':completion:*' group-name ''          # ğŸ“‚ è‡ªåŠ¨åˆ†ç»„
zstyle ':completion:*:descriptions' format '%B%d%b'  # ğŸ“ æè¿°æ ¼å¼
zstyle ':completion:*:messages' format '%d'   # ğŸ’¬ æ¶ˆæ¯æ ¼å¼
zstyle ':completion:*:warnings' format 'âŒ æœªæ‰¾åˆ°åŒ¹é…é¡¹'  # âš ï¸ è­¦å‘Šæ ¼å¼
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}  # ğŸŒˆ é¢œè‰²é…ç½®

{{if .ZshConfig.CompletionAdvanced.CachePath}}
# ğŸ’¾ è¡¥å…¨ç¼“å­˜é…ç½®
zstyle ':completion::complete:*' use-cache 1
zstyle ':completion::complete:*' cache-path "{{expandEnv .ZshConfig.CompletionAdvanced.CachePath}}"
{{end}}

# ğŸ’¡ é«˜çº§è¡¥å…¨é…ç½®ç¤ºä¾‹ (é»˜è®¤ç¦ç”¨)
# zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|=*' 'l:|=* r:|=*'  # æ™ºèƒ½åŒ¹é…
# zstyle ':completion:*:processes' command 'ps -u $USER -o pid,user,comm -w -w'      # è¿›ç¨‹è¡¥å…¨
# zstyle ':completion:*:history-words' remove-all-dups yes                           # å†å²å»é‡
{{end}}

{{if .ZshConfig.Keybindings}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         âŒ¨ï¸ ZSH é”®ç›˜ç»‘å®šé…ç½®                                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{if .ZshConfig.Keybindings.HistorySearch}}
# ğŸ” å†å²æœç´¢ç»‘å®š
{{range $key, $action := .ZshConfig.Keybindings.HistorySearch}}
bindkey "{{keyBinding $key}}" {{$action}}  # âŒ¨ï¸ {{keyBinding $key}} â†’ {{$action}}
{{end}}
{{end}}

{{if .ZshConfig.Keybindings.WordNavigation}}
# ğŸ”„ å•è¯å¯¼èˆªç»‘å®š
{{range $key, $action := .ZshConfig.Keybindings.WordNavigation}}
bindkey "{{keyBinding $key}}" {{$action}}  # âŒ¨ï¸ {{keyBinding $key}} â†’ {{$action}}
{{end}}
{{end}}

{{if .ZshConfig.Keybindings.LineNavigation}}
# â†”ï¸ è¡Œå†…å¯¼èˆªç»‘å®š
{{range $key, $action := .ZshConfig.Keybindings.LineNavigation}}
bindkey "{{keyBinding $key}}" {{$action}}  # âŒ¨ï¸ {{keyBinding $key}} â†’ {{$action}}
{{end}}
{{end}}
{{end}}

{{if .ZshConfig.GitTools}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         ğŸ”— Git å·¥å…·é›†æˆé…ç½®                                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{range $name, $tool := .ZshConfig.GitTools}}
{{if $tool.Enabled}}
# ğŸ› ï¸ {{$name | title}} å·¥å…·é…ç½®

{{if $tool.Aliases}}
# ğŸ”— {{$name | title}} åˆ«å
{{range $alias, $cmd := $tool.Aliases}}
alias {{$alias}}="{{$cmd}}"  # ğŸ”— {{$alias}} â†’ {{$cmd}}
{{end}}
{{end}}

{{if $tool.GitConfig}}
# âš™ï¸ {{$name | title}} Git é…ç½®
{{range $key, $value := $tool.GitConfig}}
git config --global {{$key}} "{{$value}}" 2>/dev/null || true  # âš™ï¸ {{$key}}
{{end}}
{{end}}
{{end}}
{{end}}

{{end}}

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                            ğŸ› ï¸ è‡ªå®šä¹‰å‡½æ•°åº“                                    â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{{if .Functions}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        âš¡ é«˜çº§è‡ªå®šä¹‰å‡½æ•°                                        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
{{range $name, $func := .Functions.Functions}}

# ğŸ”§ {{$name}} - {{$func.Description}}
{{generateFunctionComment $name $func.Zsh}}
{{$func.Zsh}}

{{end}}
{{end}}

{{if .ZshConfig.Performance}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸš€ é«˜æ€§èƒ½å¼€å‘åŠ©æ‰‹å‡½æ•°                                    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸš€ å¼€å‘é¡¹ç›®å¿«é€Ÿå¯åŠ¨å‡½æ•°
dev() {
    case "$1" in
        "go")
            if [ -f "go.mod" ]; then
                echo "ğŸ¹ å¯åŠ¨Goé¡¹ç›® (ä½¿ç”¨20æ ¸å¿ƒ)..."
                go run .
            else
                echo "âŒ ä¸æ˜¯Goé¡¹ç›®ç›®å½•"
            fi
            ;;
        "java")
            if [ -f "pom.xml" ]; then
                echo "â˜• å¯åŠ¨Spring Booté¡¹ç›® (JVMå·²ä¼˜åŒ–)..."
                mvn spring-boot:run
            elif [ -f "build.gradle" ]; then
                echo "ğŸ˜ å¯åŠ¨Gradleé¡¹ç›® (20å¹¶è¡Œä»»åŠ¡)..."
                ./gradlew bootRun
            else
                echo "âŒ ä¸æ˜¯Javaé¡¹ç›®ç›®å½•"
            fi
            ;;
        "node"|"js"|"svelte")
            if [ -f "package.json" ]; then
                echo "ğŸŸ¢ å¯åŠ¨Node.jsé¡¹ç›® (å†…å­˜ä¼˜åŒ–å·²å¯ç”¨)..."
                npm run dev
            else
                echo "âŒ ä¸æ˜¯Node.jsé¡¹ç›®ç›®å½•"
            fi
            ;;
        *)
            echo "ğŸ“‹ ç”¨æ³•: dev [go|java|node|svelte]"
            echo "ğŸš€ æ”¯æŒçš„é¡¹ç›®ç±»å‹:"
            echo "  ğŸ¹ go     - Goé¡¹ç›® (20æ ¸å¿ƒä¼˜åŒ–)"
            echo "  â˜• java   - Javaé¡¹ç›® (32GBå †å†…å­˜)"
            echo "  ğŸŸ¢ node   - Node.jsé¡¹ç›® (8GBå†…å­˜é™åˆ¶)"
            echo "  âš¡ svelte - Svelteé¡¹ç›®"
            ;;
    esac
}

# ğŸ¤– AIåŠ©æ‰‹å‡½æ•°
ai() {
    local model="${2:-deepseek-r1:7b}"
    case "$1" in
        "code")
            echo "ğŸ¤– AIä»£ç åŠ©æ‰‹ (æ¨¡å‹: $model)"
            echo "ğŸ“ è¾“å…¥ä»£ç é—®é¢˜ï¼ŒCtrl+Dç»“æŸ:"
            local input=$(cat)
            ollama run "$model" "è¯·å¸®æˆ‘åˆ†æè¿™æ®µä»£ç å¹¶æä¾›ä¼˜åŒ–å»ºè®®: $input"
            ;;
        "review")
            echo "ğŸ‘€ AIä»£ç å®¡æŸ¥ (æ¨¡å‹: $model)"
            echo "ğŸ“ è¾“å…¥è¦reviewçš„ä»£ç ï¼ŒCtrl+Dç»“æŸ:"
            local code=$(cat)
            ollama run "$model" "è¯·reviewä»¥ä¸‹ä»£ç å¹¶æå‡ºæ”¹è¿›å»ºè®®: $code"
            ;;
        "debug")
            echo "ğŸ› AIè°ƒè¯•åŠ©æ‰‹ (æ¨¡å‹: $model)"
            echo "ğŸ“ æè¿°ä½ é‡åˆ°çš„é”™è¯¯ï¼ŒCtrl+Dç»“æŸ:"
            local error=$(cat)
            ollama run "$model" "è¯·å¸®æˆ‘åˆ†æè¿™ä¸ªé”™è¯¯å¹¶æä¾›è§£å†³æ–¹æ¡ˆ: $error"
            ;;
        "explain")
            echo "ğŸ“š AIä»£ç è§£é‡Š (æ¨¡å‹: $model)"
            echo "ğŸ“ è¾“å…¥è¦è§£é‡Šçš„ä»£ç ï¼ŒCtrl+Dç»“æŸ:"
            local code=$(cat)
            ollama run "$model" "è¯·ç”¨ä¸­æ–‡è¯¦ç»†è§£é‡Šè¿™æ®µä»£ç çš„åŠŸèƒ½å’Œå·¥ä½œåŸç†: $code"
            ;;
        "optimize")
            echo "âš¡ AIæ€§èƒ½ä¼˜åŒ– (æ¨¡å‹: $model)"
            echo "ğŸ“ è¾“å…¥è¦ä¼˜åŒ–çš„ä»£ç ï¼ŒCtrl+Dç»“æŸ:"
            local code=$(cat)
            ollama run "$model" "è¯·åˆ†æè¿™æ®µä»£ç çš„æ€§èƒ½ç“¶é¢ˆå¹¶æä¾›ä¼˜åŒ–å»ºè®®ï¼Œè€ƒè™‘20æ ¸CPUå’Œ48GBå†…å­˜ç¯å¢ƒ: $code"
            ;;
        "chat")
            echo "ğŸ’¬ AIå¯¹è¯æ¨¡å¼ (æ¨¡å‹: $model)"
            ollama run "$model"
            ;;
        *)
            echo "ğŸ¤– AIåŠ©æ‰‹å¯ç”¨å‘½ä»¤:"
            echo "  ğŸ¤– ai code    - ä»£ç åˆ†æå’Œå»ºè®®"
            echo "  ğŸ‘€ ai review  - ä»£ç å®¡æŸ¥"
            echo "  ğŸ› ai debug   - é”™è¯¯è°ƒè¯•"
            echo "  ğŸ“š ai explain - ä»£ç è§£é‡Š"
            echo "  âš¡ ai optimize- æ€§èƒ½ä¼˜åŒ–å»ºè®®"
            echo "  ğŸ’¬ ai chat    - è‡ªç”±å¯¹è¯"
            echo ""
            echo "ğŸ® GPUçŠ¶æ€: $(nvidia-smi --query-gpu=utilization.gpu --format=csv,noheader,nounits 2>/dev/null || echo "N/A")% ä½¿ç”¨ä¸­"
            ;;
    esac
}

# ğŸ“Š AIçŠ¶æ€ç›‘æ§
ai_status() {
    echo "ğŸ® GPUçŠ¶æ€:"
    if command -v nvidia-smi >/dev/null 2>&1; then
        nvidia-smi --query-gpu=name,memory.used,memory.total,utilization.gpu --format=csv,noheader
    else
        echo "  âŒ æœªæ£€æµ‹åˆ°NVIDIA GPU"
    fi
    echo ""
    echo "ğŸ¤– OllamaçŠ¶æ€:"
    if command -v ollama >/dev/null 2>&1; then
        ollama ps
    else
        echo "  âŒ Ollamaæœªå®‰è£…"
    fi
    echo ""
    echo "ğŸ“Š AIæ€§èƒ½é…ç½®:"
    echo "  ğŸ”„ å¹¶è¡Œè¯·æ±‚: ${OLLAMA_NUM_PARALLEL:-4}"
    echo "  ğŸ§  é¢„åŠ è½½æ¨¡å‹: ${OLLAMA_MAX_LOADED_MODELS:-3}"
    echo "  ğŸ® GPUå†…å­˜åˆ†é…: ${OLLAMA_GPU_MEMORY_FRACTION:-0.9} (90%)"
}

# ğŸ® ç³»ç»Ÿæ¨¡å¼åˆ‡æ¢å‡½æ•°
game_mode() {
    echo "ğŸ® å¯åŠ¨æ¸¸æˆæ¨¡å¼..."
    echo ""

    # ğŸ“´ åœæ­¢å¼€å‘ç›¸å…³æœåŠ¡
    echo "ğŸ“´ åœæ­¢å¼€å‘æœåŠ¡..."
    local services=("mariadb" "valkey" "ollama" "docker")
    for service in "${services[@]}"; do
        if systemctl is-active --quiet "$service" 2>/dev/null; then
            sudo systemctl stop "$service" 2>/dev/null && echo "  âœ… $service å·²åœæ­¢"
        else
            echo "  â¸ï¸  $service æœªè¿è¡Œ"
        fi
    done

    # ğŸ® æ¸…ç†GPUå†…å­˜
    if command -v nvidia-smi >/dev/null 2>&1; then
        echo "ğŸ® æ¸…ç†GPUå†…å­˜..."
        nvidia-smi --gpu-reset >/dev/null 2>&1 && echo "  âœ… GPUå†…å­˜å·²æ¸…ç†"
    fi

    # ğŸ§¹ ç³»ç»Ÿç¼“å­˜æ¸…ç†
    echo "ğŸ§¹ æ¸…ç†ç³»ç»Ÿç¼“å­˜..."
    sync && echo 3 | sudo tee /proc/sys/vm/drop_caches >/dev/null 2>&1
    echo "  âœ… ç³»ç»Ÿç¼“å­˜å·²æ¸…ç†"

    echo ""
    echo "ğŸš€ æ¸¸æˆæ¨¡å¼å·²å¯ç”¨ï¼"
    echo "ğŸ’¡ ç³»ç»Ÿèµ„æºçŠ¶æ€:"
    echo "   ğŸ§  å†…å­˜: $(free -h | awk '/^Mem:/ {print $7}') å¯ç”¨"
    echo "   ğŸ’» CPU: 20æ ¸å¿ƒå·²é‡Šæ”¾ç»™Windows"
    echo "   ğŸ® GPU: RTXæ˜¾å­˜å·²å®Œå…¨é‡Šæ”¾"
    echo ""
    echo "ğŸ¯ ä½¿ç”¨ 'wsl --shutdown' å®Œå…¨å…³é—­WSL2é‡Šæ”¾å…¨éƒ¨èµ„æº"
}

# ğŸ’» å¼€å‘æ¨¡å¼å‡½æ•°
dev_mode() {
    echo "ğŸ’» å¯åŠ¨å¼€å‘æ¨¡å¼..."
    echo ""

    # ğŸš€ å¯åŠ¨å¼€å‘æœåŠ¡
    echo "ğŸš€ å¯åŠ¨å¼€å‘æœåŠ¡..."
    local services=("mariadb" "valkey" "ollama")
    for service in "${services[@]}"; do
        if ! systemctl is-active --quiet "$service" 2>/dev/null; then
            sudo systemctl start "$service" 2>/dev/null && echo "  âœ… $service å·²å¯åŠ¨"
        else
            echo "  âœ… $service å·²è¿è¡Œ"
        fi
    done

    # ğŸ¤– æ£€æŸ¥AIç¯å¢ƒ
    echo "ğŸ¤– æ£€æŸ¥AIç¯å¢ƒ..."
    if command -v ollama >/dev/null 2>&1; then
        echo "  âœ… Ollamaå¯ç”¨ - GPUåŠ é€Ÿå·²å¯ç”¨"
        if command -v nvidia-smi >/dev/null 2>&1; then
            echo "  ğŸ“Š GPUçŠ¶æ€: $(nvidia-smi --query-gpu=utilization.gpu --format=csv,noheader,nounits)% ä½¿ç”¨ä¸­"
        fi
    fi

    echo ""
    echo "âš¡ å¼€å‘æ¨¡å¼å·²æ¢å¤ï¼"
    echo "ğŸ”§ å¼€å‘ç¯å¢ƒçŠ¶æ€:"
    echo "   ğŸ’» CPU: 20æ ¸å¿ƒå¯ç”¨"
    echo "   ğŸ§  å†…å­˜: 48GBåˆ†é…ç»™WSL2"
    echo "   ğŸ¤– AI: Ollama + DeepSeek R1 7B å°±ç»ª"
    echo "   ğŸ“Š å¿«é€Ÿå‘½ä»¤: dev [go|java|node], ai code, ai_status"
}

# ğŸ”— åˆ«åå®šä¹‰
alias gamemode='game_mode'
alias devmode='dev_mode'

# ğŸ“Š æ€§èƒ½ç›‘æ§å‡½æ•°
perf_monitor() {
    echo "ğŸ“Š ç³»ç»Ÿæ€§èƒ½ç›‘æ§:"
    echo ""

    # ğŸ’» CPUä½¿ç”¨ç‡
    if command -v btop >/dev/null 2>&1; then
        echo "ğŸ’» CPUä½¿ç”¨ç‡:"
        echo "  ä½¿ç”¨ 'btop' æŸ¥çœ‹è¯¦ç»†CPUä½¿ç”¨æƒ…å†µ"
    fi

    # ğŸ§  å†…å­˜ä½¿ç”¨æƒ…å†µ
    echo "ğŸ§  å†…å­˜ä½¿ç”¨:"
    free -h | grep -E "Mem|Swap"

    # ğŸ’¾ ç£ç›˜I/O
    if command -v duf >/dev/null 2>&1; then
        echo ""
        echo "ğŸ’¾ ç£ç›˜ä½¿ç”¨:"
        duf
    fi

    # ğŸ® GPUçŠ¶æ€
    if command -v nvidia-smi >/dev/null 2>&1; then
        echo ""
        echo "ğŸ® GPUçŠ¶æ€:"
        nvidia-smi --query-gpu=name,utilization.gpu,memory.used,memory.total --format=csv,noheader
    fi

    # ğŸŒ ç½‘ç»œçŠ¶æ€
    echo ""
    echo "ğŸŒ ç½‘ç»œæ¥å£:"
    ip addr show | grep -E "inet.*scope global" | head -3

    # ğŸ”§ å¼€å‘æœåŠ¡çŠ¶æ€
    echo ""
    echo "ğŸ”§ å¼€å‘æœåŠ¡çŠ¶æ€:"
    for service in mariadb valkey ollama docker; do
        if systemctl is-active --quiet "$service" 2>/dev/null; then
            echo "  âœ… $service: è¿è¡Œä¸­"
        else
            echo "  â¸ï¸  $service: å·²åœæ­¢"
        fi
    done
}

alias perfmon='perf_monitor'
alias sysmon='perf_monitor'
{{end}}

{{if .Platform.WSL}}
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         ğŸªŸ WSL ç‰¹å®šå‡½æ•°                                        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ–±ï¸ æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨
open() {
    if [[ $# -eq 0 ]]; then
        explorer.exe .
    else
        explorer.exe "$@"
    fi
}

# ğŸ“‹ å¤åˆ¶åˆ° Windows å‰ªè´´æ¿
clip() {
    if [[ $# -eq 0 ]]; then
        clip.exe
    else
        echo "$@" | clip.exe
    fi
}

{{if .Platform.WSL.WindowsHome}}
# ğŸ  Windows å®¶ç›®å¿«æ·è®¿é—®
winhome() {
    cd "{{.Platform.WSL.WindowsHome}}"
}
{{end}}
{{end}}

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                         ğŸ› ï¸ å®ç”¨å·¥å…·å‡½æ•°åº“                                       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ“ åˆ›å»ºç›®å½•å¹¶è¿›å…¥
mkcd() {
    mkdir -p "$1" && cd "$1"
}

# ğŸ“¦ æ™ºèƒ½æå–å„ç§å‹ç¼©æ ¼å¼
extract() {
    if [ -f "$1" ]; then
        case "$1" in
            *.tar.bz2)   tar xjf "$1"     ;;
            *.tar.gz)    tar xzf "$1"     ;;
            *.bz2)       bunzip2 "$1"     ;;
            *.rar)       unrar x "$1"     ;;
            *.gz)        gunzip "$1"      ;;
            *.tar)       tar xf "$1"      ;;
            *.tbz2)      tar xjf "$1"     ;;
            *.tgz)       tar xzf "$1"     ;;
            *.zip)       unzip "$1"       ;;
            *.Z)         uncompress "$1"  ;;
            *.7z)        7z x "$1"        ;;
            *.xz)        unxz "$1"        ;;
            *.lzma)      unlzma "$1"      ;;
            *)           echo "âŒ '$1' æ— æ³•è¢« extract() æå–" ;;
        esac
    else
        echo "âŒ '$1' ä¸æ˜¯æœ‰æ•ˆæ–‡ä»¶"
    fi
}

# ğŸ”Œ ç«¯å£ç®¡ç†
killport() {
    if [ -z "$1" ]; then
        echo "ğŸ“‹ ç”¨æ³•: killport <ç«¯å£å·>"
        return 1
    fi
    lsof -ti:$1 | xargs kill -9
    echo "âœ… ç«¯å£ $1 ä¸Šçš„è¿›ç¨‹å·²ç»ˆæ­¢"
}

# ğŸŒ å¿«é€ŸHTTPæœåŠ¡å™¨
serve() {
    local port=${1:-8000}
    echo "ğŸŒ å¯åŠ¨HTTPæœåŠ¡å™¨åœ¨ç«¯å£ $port..."
    if command -v python >/dev/null 2>&1; then
        python -m http.server "$port"
    elif command -v python3 >/dev/null 2>&1; then
        python3 -m http.server "$port"
    else
        echo "âŒ éœ€è¦å®‰è£… Python"
    fi
}

# ğŸ“Š æ€§èƒ½ç›‘æ§å‡½æ•°
psmem() {
    if command -v procs >/dev/null; then
        procs --sortd mem | head -15
    else
        ps aux | sort -nr -k 4 | head -10
    fi
}

pscpu() {
    if command -v procs >/dev/null; then
        procs --sortd cpu | head -15
    else
        ps aux | sort -nr -k 3 | head -10
    fi
}

{{if .Paths.Projects}}
{{$projectsPath := getPlatformValue .Paths.Projects}}
{{if $projectsPath}}
# ğŸš€ å¿«é€Ÿé¡¹ç›®ç›®å½•å¯¼èˆª
cdp() {
    cd "{{expandEnv $projectsPath}}/${1:-}"
}
{{end}}
{{end}}

# â„¹ï¸ ç³»ç»Ÿä¿¡æ¯
sysinfo() {
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘            ğŸ“Š ç³»ç»Ÿä¿¡æ¯               â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "ğŸ–¥ï¸  æ“ä½œç³»ç»Ÿ: {{.Platform.OS}}/{{.Platform.Architecture}}"
    {{if .Platform.WSL}}
    {{if .Platform.WSL.Distribution}}
    echo "ğŸªŸ WSL: {{.Platform.WSL.Distribution}} ({{.Platform.WSL.Version}})"
    {{end}}
    {{end}}
    {{if .Platform.Linux}}
    {{if .Platform.Linux.Distribution}}
    echo "ğŸ§ Linux: {{.Platform.Linux.Distribution}} {{.Platform.Linux.Version}}"
    {{end}}
    {{if .Platform.Linux.PackageManager}}
    echo "ğŸ“¦ åŒ…ç®¡ç†å™¨: {{.Platform.Linux.PackageManager}}"
    {{end}}
    {{end}}
    echo "ğŸš Shell: $SHELL ($ZSH_VERSION)"
    {{if .User.Name}}
    echo "ğŸ‘¤ ç”¨æˆ·: {{.User.Name}} ({{.User.Email}})"
    {{end}}
    echo "âœï¸  ç¼–è¾‘å™¨: $EDITOR"
    echo "ğŸŒ æµè§ˆå™¨: $BROWSER"
}

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        âš¡ ZSH æ€§èƒ½ä¼˜åŒ–é…ç½®                                      â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{if .ZshConfig.Performance.AsyncLoading}}
# ğŸ”„ å¼‚æ­¥åŠ è½½é…ç½®
autoload -Uz add-zsh-hook
defer_init() {
    return 0
}
add-zsh-hook precmd defer_init
{{end}}

{{if .ZshConfig.Performance.PathDeduplication}}
# ğŸ›£ï¸ PATH å»é‡ä¼˜åŒ–
typeset -U path PATH
{{end}}

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ“¦ ZSH æ’ä»¶ç®¡ç†å™¨ (Zap)                                 â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ğŸ’¡ å®‰è£… Zap: zsh <(curl -s https://raw.githubusercontent.com/zap-zsh/zap/master/install.zsh)

if [[ -f "$HOME/.local/share/zap/zap.zsh" ]]; then
    source "$HOME/.local/share/zap/zap.zsh"

    # ğŸ”Œ æ¨èæ’ä»¶é…ç½®
    plug "zap-zsh/supercharge"             # âš¡ Zap æ ¸å¿ƒå¢å¼º
    plug "zap-zsh/exa"                     # ğŸ“ Exa ls æ›¿ä»£å·¥å…·é›†æˆ
    plug "esc/conda-zsh-completion"        # ğŸ Conda ç¯å¢ƒè¡¥å…¨
    plug "hlissner/zsh-autopair"           # âš–ï¸ æ™ºèƒ½æ‹¬å·é…å¯¹
    plug "MichaelAquilina/zsh-you-should-use"  # ğŸ’¡ å‘½ä»¤åˆ«åå»ºè®®
    plug "zap-zsh/fzf"                     # ğŸ” FZF å¢å¼ºé›†æˆ
    plug "zsh-users/zsh-autosuggestions"   # ğŸ”® å†å²å‘½ä»¤å»ºè®®
    plug "zap-zsh/zap-prompt"              # ğŸ¨ Zap é»˜è®¤ä¸»é¢˜
    plug "zsh-users/zsh-syntax-highlighting"  # ğŸŒˆ è¯­æ³•é«˜äº® (æœ€ååŠ è½½)
    plug "wintermi/zsh-brew"               # ğŸº Homebrew é›†æˆ (macOS)
    plug "Aloxaf/fzf-tab"                  # ğŸ“‹ FZF Tab è¡¥å…¨å¢å¼º
else
    echo "âš ï¸  Zap æ’ä»¶ç®¡ç†å™¨æœªå®‰è£…"
    echo "ğŸ“‹ å®‰è£…: zsh <(curl -s https://raw.githubusercontent.com/zap-zsh/zap/master/install.zsh)"
fi

# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚                        ğŸ“ æœ¬åœ°è‡ªå®šä¹‰é…ç½®                                        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{{if .ZshConfig.XDGDirectories.Enabled}}
[[ -f "$XDG_CONFIG_HOME/zsh/zshrc.local" ]] && source "$XDG_CONFIG_HOME/zsh/zshrc.local"
{{else}}
[[ -f "$HOME/.zshrc.local" ]] && source "$HOME/.zshrc.local"
{{end}}

# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                      ğŸ‰ ZSH é…ç½®åŠ è½½å®Œæˆ ğŸ‰                                  â•‘
# â•‘                    æ¬¢è¿ä½¿ç”¨ dotfiles-go é…ç½®                                  â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
