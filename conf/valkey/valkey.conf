# Valkey 性能优化配置
# 数据目录: ~/.local/share/valkey

# 网络配置
bind 127.0.0.1
port 6379
timeout 300
tcp-keepalive 300
tcp-backlog 511

# 数据持久化
dir /home/afu/.local/share/valkey
dbfilename dump.rdb
save 900 1
save 300 10
save 60 10000

# AOF持久化
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# 内存配置 (8GB专用)
maxmemory 8GB
maxmemory-policy allkeys-lru

# 客户端配置
maxclients 1000
databases 16

# 安全配置
protected-mode no
# requirepass dev2024

# 日志配置
loglevel notice
logfile /home/afu/.cache/valkey/valkey.log

# 性能优化
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
set-max-intset-entries 512

# Redis 兼容性配置
# 禁用某些可能影响GUI客户端的新特性
notify-keyspace-events ""
client-output-buffer-limit normal 0 0 0 slave 268435456 67108864 60 pubsub 33554432 8388608 60